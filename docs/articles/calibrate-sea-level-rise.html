<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calibration to sea level rise â€¢ deltasalinity</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Calibration to sea level rise">
<meta property="og:description" content="deltasalinity">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">deltasalinity</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/calibrate-sea-level-rise.html">Calibration to sea level rise</a>
    </li>
    <li>
      <a href="../articles/simulate-salinity.html">An advection and first-order exchange model of channel salinity</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="calibrate-sea-level-rise_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Calibration to sea level rise</h1>
            
      
      
      <div class="hidden name"><code>calibrate-sea-level-rise.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">deltasalinity</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></code></pre></div>
<p>Previously, the salinity model was defined as: <span class="math display">\[\frac{dC}{dt} = - a Q_H (C - C_U) +  b e^{-dQ_H}(C_D - C)\,.\]</span> This model contains appropriate parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(d\)</span> for calibration. However, the model was originally derived via control volume as: <span class="math display">\[\frac{dC}{dt} = - \frac{Q_C}{V} (C - C_U) + \frac{Q_E}{V} (C_D - C)\,,\]</span> where <span class="math inline">\(Q_C\)</span> is channel flow, <span class="math inline">\(V\)</span> is the volume of water in the control volume, <span class="math inline">\(C_U\)</span> is upstream salinity concentration, <span class="math inline">\(Q_E\)</span> is the exchange flow with downstream, and <span class="math inline">\(C_D\)</span> is downstream salinity. We can re-calibrate the model with sea level rise by making appropriate adjustments to <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> and calibrating only on the parameter <span class="math inline">\(d\)</span>. Note that this requires estimates of salinity under sea level rise, but that the calibration is improved because only <span class="math inline">\(d\)</span> must be calibration. The sea-level-rise adjustments assume that sea-level rise will affect both the mean volume of water stored in the control volume and that the exchange flow is proportional to the variable storage in the control volume due to tidal oscillations (<span class="math inline">\(Q_E \propto \Delta V\)</span>). We assume the original model was calibrated under current conditions represented by <span class="math inline">\(V = V_1\)</span> and <span class="math inline">\(\Delta V = \Delta V_1\)</span> (and captured by coefficients <span class="math inline">\(a_1\)</span>, <span class="math inline">\(b_1\)</span>, and <span class="math inline">\(d_1\)</span>) and that sea level rise leads to new conditions <span class="math inline">\(V = V_2\)</span> and <span class="math inline">\(\Delta V = \Delta V_2\)</span> (captured by <span class="math inline">\(a_2\)</span>, <span class="math inline">\(b_2\)</span>, and <span class="math inline">\(d_2\)</span>). Because we define <span class="math inline">\(a_1 = Q_C/ (V_1 Q_H)\)</span> and <span class="math inline">\(a_2 = Q_C/ (V_2 Q_H)\)</span>, we can say that <span class="math display">\[a_2 = a_1 V_1 / V_2\,.\]</span> Similarly, <span class="math inline">\(b_1 = Q_{E1}/ V_1\)</span> and <span class="math inline">\(b_2 = Q_{E2}/ V_2\)</span> so that <span class="math inline">\(b_2 = b_1 Q_{E2}/Q_{E1} \times V_1/V_2\)</span> or <span class="math display">\[b_2 = b_1 \frac{\Delta V_2}{\Delta V_1}\frac{V_1}{V_2}\,.\]</span></p>
<p>In other words, the key to adjusting <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> for sea level rise is determining the ratio of exchange volumes and ratio of volumes. Then <span class="math inline">\(d\)</span> can be re-calibrated directly to climate projections if such data are available. For clarity, we rewrite these ratios as <span class="math inline">\(R_E = \Delta V_2/\Delta V_1\)</span> and <span class="math inline">\(R_V = V_2/V_1\)</span> and therefore <span class="math inline">\(a_2 = a_1 / R_V\)</span> and <span class="math inline">\(b_2 = b_1 R_E / R_V\)</span>. We therefore need appropriate functions for <span class="math inline">\(R_E\)</span> and <span class="math inline">\(R_V\)</span> with sea level rise as the independent variable. There are two ways in which this could be done, representing two extremes:</p>
<ol style="list-style-type: decimal">
<li>The control volume in which salinity mixes is confined to water in the channel, and</li>
<li>The control volume comprises the channel and groundwater which are perfectly connected and mixed.</li>
</ol>
<p>Both approaches are described in the following section.</p>
<div id="adjusting-parameters-a-and-b" class="section level1">
<h1 class="hasAnchor">
<a href="#adjusting-parameters-a-and-b" class="anchor"></a>Adjusting parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>
</h1>
<div id="control-volume-of-isolated-channel" class="section level2">
<h2 class="hasAnchor">
<a href="#control-volume-of-isolated-channel" class="anchor"></a>Control volume of isolated channel</h2>
<p>If the channel is completely isolated from groundwater, then calculating <span class="math inline">\(R_E\)</span> and <span class="math inline">\(R_V\)</span> requires calculating <span class="math inline">\(V\)</span> and <span class="math inline">\(\Delta V\)</span> in the channel with and without sea level rise. We have done this by interpolating channel cross-sectional area at 16 locations spanning the Gorai to the Rupsa river. Channel area was fit as a power law of river stage at each of the 16 locations. The mean stage at each cross section was determined for present conditions via a linear interpolation from SW99 (the start of the Gorai river) to SW244 (Mongla, the most downstream location). We assumed that sea level rise would increase mean stage equally through the delta, so that the channel area under sea level rise could be calculated at each cross section using the original stage + sea level rise. We assumed that tidal oscillations dissipating as an exponential function moving further upstream. We therefore interpolated an exponential function to pass through the observed tidal oscillations at SW99 and SW244, and assumed that the magnitude of tidal oscillations (high tide - low tide) would remain constant with sea level rise. The change in channel area would therefore simply be recalculated as channel area with SLR at high tide minus channel area with SLR at low tide. The net result of this analysis produced curves for <span class="math inline">\(R_E\)</span> and <span class="math inline">\(R_V\)</span> that were nearly linear (R<span class="math inline">\(^2\)</span> &gt; 0.99) for sea level rise in the range <span class="math inline">\([0,1]\)</span> m.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">channel_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ganges_SLR_ratios.html">get_ganges_SLR_ratios</a></span><span class="op">(</span>SLR_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">channel_ratios</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_m</span>, <span class="va">R_E</span>, color <span class="op">=</span> <span class="st">"R_E"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_m</span>, <span class="va">R_V</span>, color <span class="op">=</span> <span class="st">"R_V"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="calibrate-sea-level-rise_files/figure-html/unnamed-chunk-2-1.png" width="384"></p>
</div>
<div id="control-volume-of-fully-mixed-channel-and-groundwater" class="section level2">
<h2 class="hasAnchor">
<a href="#control-volume-of-fully-mixed-channel-and-groundwater" class="anchor"></a>Control volume of fully mixed channel and groundwater</h2>
<p>In the fully mixed version, we assume that the total volume is simply proportional to the depth of the water in the channel â€“ in other words, the elevation of the water surface minus the elevation of the river bed. We take the average across all cross sections in the Gorai - Naboganga - Rupsa river, with and without sea level rise, to determine <span class="math inline">\(R_V\)</span>. Because the magnitude of tidal oscillations does not depend on sea level rise, <span class="math inline">\(R_E = 1\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gw_ratios</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_ganges_SLR_ratios.html">get_ganges_SLR_ratios</a></span><span class="op">(</span>SLR_m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>, <span class="st">"gw"</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">gw_ratios</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_m</span>, <span class="va">R_E</span>, color <span class="op">=</span> <span class="st">"R_E"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_m</span>, <span class="va">R_V</span>, color <span class="op">=</span> <span class="st">"R_V"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Ratio"</span><span class="op">)</span></code></pre></div>
<p><img src="calibrate-sea-level-rise_files/figure-html/unnamed-chunk-3-1.png" width="384"></p>
</div>
<div id="calibrate-to-dasgupta-et-al--2015" class="section level2">
<h2 class="hasAnchor">
<a href="#calibrate-to-dasgupta-et-al--2015" class="anchor"></a>Calibrate to Dasgupta et al., 2015</h2>
<p>S. Dasgupta, F.A. Kamal, Z.H. Khan, S. Choudhury, A. Nishat, River salinity and climate change: Evidence from coastal Bangladesh, World Sci. Ref. Asia World Econ. (2015) 205â€“242. <a href="doi:10.1142/9789814578622_0031" class="uri">doi:10.1142/9789814578622_0031</a>.</p>
<p>Here the authors develop a mode to simulate salinity in the GBM delta by combining a localized rainfall-runoff model, a hydrodynamic (water flow and water level) module (MIKE 11), a Bay of Bengal salinity model based on MIKE 21FM, and a salinity model by combining advection-dispersion from MIKE 11 with the hydrodynamic model. The simulations included average inflor from India calculated as the average since the treaty was signed (1998-2013).</p>
<p>They simulate multiple scenarios in 2050, and plot the results for three specific scenarios:</p>
<ul>
<li>Baseline (2012) â€“ March average salinity is 5 ppt</li>
<li>Best future, 35 cm RMSLR (8 cm subsidence + 27 cm SLR) â€“ March salinity is 8.046875 ppt, or an increase of 60.9375%.</li>
<li>Best future, 67 cm RMSLR (34 cm subsidence + 33 cm SLR) â€“ March salinity is 9.15 ppt, or an increase of 83%.</li>
</ul>
<p>Subsidence throughout the entire delta would cause the hydrodynamics within the delta to behave similarly to sea level rise. We therefore calibrate our model using the RMSLR scenarios directly as SLR.</p>
<div id="prepare-calibration-data" class="section level3">
<h3 class="hasAnchor">
<a href="#prepare-calibration-data" class="anchor"></a>Prepare calibration data</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">treaty_streamflow</span> <span class="op">&lt;-</span> <span class="va">ganges_streamflow</span><span class="op">[</span><span class="va">ganges_streamflow</span><span class="op">$</span><span class="va">group</span> <span class="op">==</span> <span class="st">"Treaty avg"</span>,<span class="op">]</span>
<span class="va">treat_salinity_35cm</span> <span class="op">&lt;-</span> <span class="va">treaty_streamflow</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span>S_ppm_model_baseline <span class="op">=</span> <span class="fu"><a href="../reference/sim_salin_annual.html">sim_salin_annual</a></span><span class="op">(</span><span class="va">treaty_streamflow</span>, v <span class="op">=</span> <span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>S_ppm_SLR_calibrate <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"1998-03-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"1998-03-31"</span>,
                                       <span class="va">S_ppm_model_baseline</span> <span class="op">*</span> <span class="op">(</span><span class="va">dasgupta_slr35cm_pct_increase</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">treat_salinity_67cm</span> <span class="op">&lt;-</span> <span class="va">treaty_streamflow</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span>S_ppm_model_baseline <span class="op">=</span> <span class="fu"><a href="../reference/sim_salin_annual.html">sim_salin_annual</a></span><span class="op">(</span><span class="va">treaty_streamflow</span>, v <span class="op">=</span> <span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>S_ppm_SLR_calibrate <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;=</span> <span class="st">"1998-03-01"</span> <span class="op">&amp;</span> <span class="va">date</span> <span class="op">&lt;=</span> <span class="st">"1998-03-31"</span>,
                                       <span class="va">S_ppm_model_baseline</span> <span class="op">*</span> <span class="op">(</span><span class="va">dasgupta_slr67cm_pct_increase</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="update-calibration-parameters-a-and-b" class="section level3">
<h3 class="hasAnchor">
<a href="#update-calibration-parameters-a-and-b" class="anchor"></a>Update calibration parameters a and b</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get new a and b calibration parameters</span>
<span class="va">v_ab_channel_slr35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_ab_SLR.html">update_ab_SLR</a></span><span class="op">(</span><span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, SLR_m <span class="op">=</span> <span class="fl">0.35</span>, <span class="st">"channel"</span><span class="op">)</span>
<span class="va">v_ab_channel_slr67</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_ab_SLR.html">update_ab_SLR</a></span><span class="op">(</span><span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, SLR_m <span class="op">=</span> <span class="fl">0.67</span>, <span class="st">"channel"</span><span class="op">)</span>
<span class="va">v_ab_gw_slr35</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_ab_SLR.html">update_ab_SLR</a></span><span class="op">(</span><span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, SLR_m <span class="op">=</span> <span class="fl">0.35</span>, <span class="st">"gw"</span><span class="op">)</span>
<span class="va">v_ab_gw_slr67</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_ab_SLR.html">update_ab_SLR</a></span><span class="op">(</span><span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, SLR_m <span class="op">=</span> <span class="fl">0.67</span>, <span class="st">"gw"</span><span class="op">)</span></code></pre></div>
</div>
<div id="calibrate-parameter-d" class="section level3">
<h3 class="hasAnchor">
<a href="#calibrate-parameter-d" class="anchor"></a>Calibrate parameter d</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># sea level rise of 35 cm</span>
<span class="va">v_slr35_channel</span> <span class="op">&lt;-</span> <span class="va">treat_salinity_35cm</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>S_ppm <span class="op">=</span> <span class="va">S_ppm_SLR_calibrate</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/calibrate_salinity_model.html">calibrate_salinity_model</a></span><span class="op">(</span><span class="va">v_ab_channel_slr35</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Calibrating using Nelder-Mead method...</span>
<span class="co">#&gt; Warning in stats::optim(par = v_init[is.na(v)], fn = sse_wrapper, hydro_data = hydro_data, : one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span>
<span class="va">v_slr35_gw</span> <span class="op">&lt;-</span> <span class="va">treat_salinity_35cm</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>S_ppm <span class="op">=</span> <span class="va">S_ppm_SLR_calibrate</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/calibrate_salinity_model.html">calibrate_salinity_model</a></span><span class="op">(</span><span class="va">v_ab_gw_slr35</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Calibrating using Nelder-Mead method...</span>
<span class="co">#&gt; Warning in stats::optim(par = v_init[is.na(v)], fn = sse_wrapper, hydro_data = hydro_data, : one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span>

<span class="co"># sea level rise of 67 cm</span>
<span class="va">v_slr67_channel</span> <span class="op">&lt;-</span> <span class="va">treat_salinity_67cm</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>S_ppm <span class="op">=</span> <span class="va">S_ppm_SLR_calibrate</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/calibrate_salinity_model.html">calibrate_salinity_model</a></span><span class="op">(</span><span class="va">v_ab_channel_slr67</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Calibrating using Nelder-Mead method...</span>
<span class="co">#&gt; Warning in stats::optim(par = v_init[is.na(v)], fn = sse_wrapper, hydro_data = hydro_data, : one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span>
<span class="va">v_slr67_gw</span> <span class="op">&lt;-</span> <span class="va">treat_salinity_67cm</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>S_ppm <span class="op">=</span> <span class="va">S_ppm_SLR_calibrate</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/calibrate_salinity_model.html">calibrate_salinity_model</a></span><span class="op">(</span><span class="va">v_ab_gw_slr67</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Calibrating using Nelder-Mead method...</span>
<span class="co">#&gt; Warning in stats::optim(par = v_init[is.na(v)], fn = sse_wrapper, hydro_data = hydro_data, : one-dimensional optimization by Nelder-Mead is unreliable:</span>
<span class="co">#&gt; use "Brent" or optimize() directly</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get_ganges_slr_params &lt;- function(hydro_data, v, SLR_m, control_volume) {</span>
<span class="co">#   v_ab_channel &lt;- update_ab_SLR(v = v, SLR_m = SLR_m, control_volume = control_volume)</span>
<span class="co">#   </span>
<span class="co">#   v_slr &lt;- hydro_data %&gt;% rename(S_ppm = S_ppm_SLR_calibrate) %&gt;% </span>
<span class="co">#     calibrate_salinity_model(v_ab, control = list(trace = FALSE))</span>
<span class="co"># }</span></code></pre></div>
</div>
</div>
<div id="calibrate-to-akter-et-al" class="section level2">
<h2 class="hasAnchor">
<a href="#calibrate-to-akter-et-al" class="anchor"></a>Calibrate to Akter et al,</h2>
<p>R. Akter, M. Sakib, M. Rahman, Sumaiya, A. Haque, M.M. Rahman, M.R. Islam, CLIMATIC AND CYCLONE INDUCED STORM SURGE IMPACT ON SALINITY INTRUSION ALONG THE BANGLADESH COAST, in: Proc. 6th Int. Conf. Appl. Phys. Model. Coast. Port Eng. Sci., Ottawa, Canada, 2016.</p>
<p>In this paper, the authors build a salinity model for the GBM delta and simulate salnity throughout the delta in 2011 under current conditions and in 2092 with a temperature increase of 4<span class="math inline">\(^\circ\)</span>C and a sea level rise of 0.54 m. In both cases, streamflow data from 2011 was used.</p>
<p>They simulate two scenarios including 2011 and 2092:</p>
<ul>
<li>Baseline (2011) â€“ June 6 salinity at Khulna is 5 ppt</li>
<li>Climate change with 54 cm SLR â€“ June 6 salinity is 13.011611 ppt, or an increase of 160.2322206%.</li>
</ul>
<p>The calibration is done in a separate file with 2011 streamflow to achieve the results below.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v_slr54_channel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12.6496881185107</span>,<span class="op">-</span><span class="fl">4.25847441165473</span>,<span class="op">-</span><span class="fl">6.64196860125567</span>,<span class="fl">10.4631033404715</span><span class="op">)</span>
<span class="va">v_slr54_gw</span> <span class="op">&lt;-</span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">12.6090585920122</span>,<span class="op">-</span><span class="fl">4.25588413142161</span>,<span class="op">-</span><span class="fl">6.64803987054384</span>,<span class="fl">10.4631033404715</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="combine-calibration-results" class="section level1">
<h1 class="hasAnchor">
<a href="#combine-calibration-results" class="anchor"></a>Combine calibration results</h1>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, <span class="va">ganges_params</span><span class="op">$</span><span class="va">param</span>, <span class="va">v_slr35_channel</span>, <span class="va">v_slr35_gw</span>, <span class="va">v_slr67_channel</span>, <span class="va">v_slr67_gw</span>, <span class="va">v_slr54_channel</span>, <span class="va">v_slr54_gw</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">8</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"SLR_Baseline_0"</span>, <span class="st">"SLR_Dasgupta2014_35"</span>,<span class="st">"SLR_Dasgupta2014_67"</span>,<span class="st">"SLR_Akter2016_54"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_cols</a></span><span class="op">(</span>log_var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"log(a)"</span>,<span class="st">"log(b)"</span>,<span class="st">"log(d)"</span>,<span class="st">"log(C_d)"</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, geometry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"channel"</span>,<span class="st">"gw"</span><span class="op">)</span>, each <span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"SLR_"</span><span class="op">)</span>,names_to <span class="op">=</span> <span class="st">"source_slr"</span>, names_prefix <span class="op">=</span> <span class="st">"SLR_"</span>, values_to <span class="op">=</span> <span class="st">"log_param"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">source_slr</span>,into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"source"</span>,<span class="st">"SLR_cm"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>SLR_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">SLR_cm</span><span class="op">)</span>,
         param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">log_param</span><span class="op">)</span>,
         var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span><span class="st">".*\\((.*?)\\)"</span>,<span class="st">"\\1"</span>,<span class="va">log_var</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>The calibrated <span class="math inline">\(d\)</span> is very similar for the channel control volume and groundwater-connected control volume. the difference between the two is less than 1% in all cases (see below). We therefore use the minimum and maximum slope for <span class="math inline">\(d\)</span> from the combined calibrations and assume that they apply in all cases.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">slr_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">var</span> <span class="op">==</span> <span class="st">"d"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d_0 <span class="op">=</span> <span class="va">param</span><span class="op">[</span><span class="va">SLR_cm</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">log_param</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">SLR_cm</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"geometry"</span>,<span class="st">"var"</span><span class="op">)</span>, values_from <span class="op">=</span> <span class="st">"param"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>pct_diff <span class="op">=</span> <span class="op">(</span><span class="va">gw_d</span> <span class="op">-</span> <span class="va">channel_d</span><span class="op">)</span> <span class="op">/</span> <span class="va">channel_d</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">SLR_cm</span>, `d, % diff between gw and channel` <span class="op">=</span> <span class="va">pct_diff</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   SLR_cm `d, % diff between gw and channel`</span>
<span class="co">#&gt;    &lt;dbl&gt;                              &lt;dbl&gt;</span>
<span class="co">#&gt; 1     35                          -0.000450</span>
<span class="co">#&gt; 2     67                          -0.00180 </span>
<span class="co">#&gt; 3     54                          -0.00605</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d_bounds</span> <span class="op">&lt;-</span> <span class="va">slr_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">var</span> <span class="op">==</span> <span class="st">"d"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d_0 <span class="op">=</span> <span class="va">param</span><span class="op">[</span><span class="va">SLR_cm</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">log_param</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">SLR_cm</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d_slope <span class="op">=</span> <span class="op">(</span><span class="va">param</span> <span class="op">-</span> <span class="va">d_0</span><span class="op">)</span> <span class="op">/</span> <span class="va">SLR_cm</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">d_slope</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">d_slope</span><span class="op">)</span> <span class="op">|</span> <span class="va">d_slope</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">d_slope</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">d_0</span>, <span class="va">d_slope</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>slope <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">d_slope</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">d_slope</span><span class="op">)</span>, <span class="st">"d_slope_max"</span>,<span class="st">"d_slope_min"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"slope"</span>, values_from <span class="op">=</span> <span class="st">"d_slope"</span><span class="op">)</span>
<span class="va">d_bounds</span>
<span class="co">#&gt; # A tibble: 1 x 3</span>
<span class="co">#&gt;       d_0 d_slope_max d_slope_min</span>
<span class="co">#&gt;     &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt; 1 0.00206 -0.00000724  -0.0000141</span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">d_ribbon</span> <span class="op">&lt;-</span> <span class="va">d_bounds</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand.html">crossing</a></span><span class="op">(</span>SLR_cm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">slr_data</span><span class="op">$</span><span class="va">SLR_cm</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">slr_data</span><span class="op">$</span><span class="va">SLR_cm</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>d_min <span class="op">=</span> <span class="va">d_0</span> <span class="op">+</span> <span class="va">d_slope_min</span> <span class="op">*</span> <span class="va">SLR_cm</span>,
         d_max <span class="op">=</span> <span class="va">d_0</span> <span class="op">+</span> <span class="va">d_slope_max</span> <span class="op">*</span> <span class="va">SLR_cm</span>,
         var <span class="op">=</span> <span class="st">"d"</span><span class="op">)</span>
<span class="va">p_slr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">slr_data</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">var</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"d"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_cm</span>, <span class="va">param</span>, shape <span class="op">=</span> <span class="va">source</span>, color <span class="op">=</span> <span class="va">geometry</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, stroke <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">d_ribbon</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">SLR_cm</span>, ymin <span class="op">=</span> <span class="va">d_min</span>, ymax <span class="op">=</span> <span class="va">d_max</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">var</span>, scales <span class="op">=</span> <span class="st">"free_y"</span><span class="op">)</span>
<span class="va">p_slr</span></code></pre></div>
<p><img src="calibrate-sea-level-rise_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># ggsave("slr_parameters.png",p_slr, path = "~/Desktop", width = 8, height = 2)</span></code></pre></div>
<!-- This equation was derived from  -->
<!-- ```{r} -->
<!-- tibble::tribble(~direction, ~side, ~y, -->
<!--         1, 0, 0.5)  -->
<!-- ggplot() +  -->
<!--   geom_rect(aes(xmin = 0, xmax = 1, ymin = 0, ymax = 1)) +  -->
<!--   annotate("segment", -0.5,0.5, xend = 0, yend = 0.5, arrow = arrow()) + -->
<!--   annotate("segment", 1,0.5, xend = 1.5, yend = 0.5, arrow = arrow()) + -->
<!--   coord_equal() -->
<!-- ``` -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Gopal Penny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
